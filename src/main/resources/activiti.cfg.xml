<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-4.1.xsd">

    <!-- 引擎内部提供的UUID生成器，依赖fastxml的java-uuid-generator模块 -->
    <bean id="uuidGenerator" class="org.activiti.engine.impl.persistence.StrongUuidGenerator"/>
    
	<!-- 流程引擎配置 -->
	<bean id="processEngineConfiguration" class="org.activiti.spring.SpringProcessEngineConfiguration">
		<property name="customSessionFactories">
            <list>
                <bean class="com.cmp.activiti.CustomUserEntityManagerFactory"/>
                <bean class="com.cmp.activiti.CustomGroupEntityManagerFactory"/>
            </list>
        </property>
    	<property name="databaseType" value="mysql"/><!-- 基于JDBC参数配置的数据库连接会使用默认的MyBatis连接池 -->
    	<property name="dataSource" ref="dataSource"/>
    	<property name="databaseSchemaUpdate" value="true"/><!-- false(默认)：检查数据库表的版本和依赖库的版本， 如果版本不匹配就抛出异常；true: 构建流程引擎时，执行检查，如果需要就执行更新。 如果表不存在，就创建；create-drop: 构建流程引擎时创建数据库表， 关闭流程引擎时删除这些表 -->
    	<property name="jobExecutorActivate" value="false"/><!-- 禁止流程引擎启动时激活 -->
		<property name="asyncExecutorEnabled" value="true"/>
		<property name="asyncExecutorActivate" value="false"/>
		<property name="createDiagramOnDeploy" value="true"/><!-- 生成流程定义 -->
		<property name="deploymentResources" value="classpath*:activiti.default.*.bpmn"/><!-- 防止资源重新部署(资源未改变)".bpmn"及".bpmn20.xml" -->
		<property name="deploymentMode" value="single-resource"/><!-- 发布策略：default(默认)-一起发布；single-resource-单独发布；resource-parent-folder-同一上级目录单独发布 -->
		<property name="transactionManager" ref="transactionManager"/><!-- 事务管理器 -->
		<property name="mailServerHost" value="smtp.wasu.com"/><!-- 邮件服务器SMTP主机名，默认为localhost -->
		<property name="mailServerPort" value="25"/><!-- 邮件服务器SMTP传输端口。默认为25 -->
		<property name="mailServerDefaultFrom" value="chenwenm@wasu.com"/><!-- 默认设置发送者邮件地址，默认为activiti@activiti.org -->
		<property name="mailServerUsername" value="chenwenm"/><!-- 邮件服务器用户名 -->
		<property name="mailServerPassword" value="wasu96371"/><!-- 邮件服务器用密码 -->
		<property name="mailServerUseSSL" value="false"/><!-- 邮件服务器是否需要SSL交互，默认为false -->
		<property name="mailServerUseTLS" value="false"/><!-- 邮件服务器是否需要TLS交互，默认为false -->
		<property name="history" value="audit"/><!-- none；activity；audit(默认)；full -->
		<property name="activityFontName" value="微软雅黑"></property>
	</bean>
	
	<bean id="processEngine" class="org.activiti.spring.ProcessEngineFactoryBean">
		<property name="processEngineConfiguration" ref="processEngineConfiguration"/>
	</bean>
	
	<bean id="repositoryService" factory-bean="processEngine" factory-method="getRepositoryService"/><!-- 仓库服务 -->
  	<bean id="runtimeService" factory-bean="processEngine" factory-method="getRuntimeService"/><!-- 流程实例服务 -->
  	<bean id="taskService" factory-bean="processEngine" factory-method="getTaskService"/><!-- 任务服务 -->
  	<bean id="identityService" factory-bean="processEngine" factory-method="getIdentityService"/><!-- 标识服务 -->
  	<bean id="formService" factory-bean="processEngine" factory-method="getFormService"/><!-- 表单服务 -->
  	<bean id="managementService" factory-bean="processEngine" factory-method="getManagementService"/><!-- 管理服务 -->
  	<bean id="historyService" factory-bean="processEngine" factory-method="getHistoryService"/><!-- 历史服务 -->

	<!-- <serviceTask id="sendMail" activiti:type="mail">
		<extensionElements>
			<activiti:field name="from" stringValue="order-shipping@thecompany.com"/>
			<activiti:field name="to" expression="${recipient}"/>
			<activiti:field name="subject"
				expression="Your order ${orderId} has been shipped"/>
			<activiti:field name="html">
				<activiti:expression>
			        <![CDATA[
			          <html>
			            <body>
			              Hello ${male ? 'Mr.' : 'Mrs.' } ${recipientName},<br/><br/>
			              As of ${now}, your order has been <b>processed and shipped</b>.<br/><br/>
			              Kind regards,<br/>
			              TheCompany.
			            </body>
			          </html>
			        ]]>
				</activiti:expression>
			</activiti:field>
		</extensionElements>
	</serviceTask> -->
</beans>